# Evolution Queue
# Proposals generated by AC-05 Self-Reflection, pending AC-06 Self-Evolution

proposals:
  - id: EVO-2026-01-020
    date: "2026-01-20"
    source: reflection
    priority: low
    status: queued
    summary: "Session State Auto-Update"
    problem: |
      Session state can drift from actual work when context compaction occurs mid-task.
      Current work shown in session-state.md may not reflect actual in-progress task.
    proposal: |
      Add hook or checkpoint logic to auto-update session-state.md current work section when:
      - TodoWrite changes in_progress task
      - Context compaction triggers
      - Checkpoint is created
    implementation:
      - Hook on TodoWrite status changes
      - Update checkpoint creation logic
      - Parse todo content to update "Current Work" section
    estimated_effort: low
    related:
      - ".claude/hooks/context-accumulator.js"
      - ".claude/context/session-state.md"
      - ".claude/skills/session-management/SKILL.md"

  - id: EVO-2026-01-021
    date: "2026-01-20"
    source: prd-v5-self-reflection
    priority: low
    status: completed
    summary: "Specific Error Messages Pattern"
    problem: |
      Generic error messages like "Invalid input" don't help users understand what went wrong.
      Should specify exactly which parameter failed and what valid values are.
    proposal: |
      Establish pattern for API error messages:
      - Always name the failing parameter
      - List valid options when enumerable
      - Include the invalid value that was received
    implementation:
      - Template: "Unknown {param}: {value}. Valid {param}s: {list}"
      - Apply to all parameter validation errors
    estimated_effort: low
    validation: PRD-V5 correction applied and tested
    related:
      - ".claude/context/lessons/self-corrections.md"
      - "PRD-V5 Correction #3"

  - id: EVO-2026-01-022
    date: "2026-01-20"
    source: prd-v5-self-reflection
    priority: low
    status: completed
    summary: "Edge Case Testing Checklist"
    problem: |
      Missing empty string test case in PRD-V5 slugify function.
      Edge cases can be systematically overlooked without a checklist.
    proposal: |
      Standard edge case checklist for string functions:
      - Empty string ('')
      - Null/undefined
      - Single character
      - Special characters only
      - Whitespace only
      - Very long strings
    implementation:
      - Add to test template
      - Reference in code-tester agent guidelines
    estimated_effort: low
    validation: PRD-V5 correction applied and tested
    related:
      - ".claude/context/lessons/self-corrections.md"
      - "PRD-V5 Correction #1"

  - id: EVO-2026-02-001
    date: "2026-02-05"
    source: reflection
    priority: low
    status: queued
    summary: "Watcher Health Check at Session Start"
    problem: |
      No visibility into watcher state at session start. Duplicate watcher bug was only
      discovered when user noticed two watchers running. Early detection would help.
    proposal: |
      Add watcher health verification to session-start hook:
      1. Check if watcher is running (pgrep)
      2. Verify single instance (count processes)
      3. Log warning if multiple or none
      4. Do NOT launch (leave that to tmux launcher)
    implementation:
      - Modify session-start.sh to add watcher_health_check() function
      - Log to session-start-diagnostic.log
      - Warning only, no action (avoids race conditions)
    estimated_effort: low
    related:
      - ".claude/hooks/session-start.sh"
      - "PAT-006: Single authority for process launch"
      - ".claude/reports/reflections/reflection-2026-02-05.md"

  - id: EVO-2026-02-002
    date: "2026-02-08"
    source: reflection
    priority: medium
    status: queued
    summary: "Auto-Sync State Files After Validation"
    problem: |
      AC component state JSON files diverge from spec markdown validation checklists.
      AC-03 showed triggers_tested: false when spec confirmed live test on PR-12.4.
    proposal: |
      Add post-validation state sync to milestone review workflow:
      1. After validation checklist updates, prompt for state file update
      2. Or add hook that detects spec checkbox changes and syncs state file
    implementation:
      - Modify milestone-review-pattern.md to include state sync step
      - Consider automated sync via /review-milestone command
    estimated_effort: low
    related:
      - ".claude/state/components/AC-03-review.json"
      - ".claude/context/components/AC-03-milestone-review.md"
      - ".claude/reports/reflections/reflection-2026-02-08.md"

  - id: EVO-2026-02-003
    date: "2026-02-08"
    source: reflection-omc
    priority: medium
    status: queued
    summary: "Model Tier Routing in Capability Map"
    problem: |
      Jarvis uses ad-hoc model selection per task. OMC demonstrates 30-50% cost savings
      via explicit Haiku/Sonnet/Opus tier routing by task complexity.
    proposal: |
      Add model recommendation field to capability-map.yaml entries:
      - haiku: quick lookups, simple research, status checks
      - sonnet: standard implementation, research, analysis
      - opus: complex architecture, multi-file changes, critical decisions
    implementation:
      - Add `recommended_model` field to capability-map.yaml skill entries
      - Update manifest router to surface model recommendation
    estimated_effort: low
    related:
      - ".claude/context/psyche/capability-map.yaml"
      - ".claude/context/research/omc-patterns-analysis.md"
      - ".claude/reports/reflections/reflection-2026-02-08.md"

  - id: EVO-2026-02-004
    date: "2026-02-08"
    source: reflection
    priority: low
    status: queued
    summary: "Computed State Over Maintained State Pattern"
    problem: |
      Hardcoded counts (patterns, skills, agents) drift from actual values.
      Static boolean flags in state files become stale. Manual maintenance fails at scale.
    proposal: |
      Document pattern: prefer computed state over maintained state.
      - Use glob counts instead of hardcoded numbers
      - Use file existence checks instead of boolean flags
      - Reserve state files for values that genuinely need persistence (counters, timestamps)
    implementation:
      - Create pattern: computed-state-pattern.md
      - Audit existing state files for candidates to convert
    estimated_effort: low
    related:
      - "MEMORY.md (hardcoded counts drift gotcha)"
      - ".claude/state/components/"
      - ".claude/reports/reflections/reflection-2026-02-08.md"

# Queue maintained by AC-05/AC-06 â€” Updated 2026-02-08
